## Бизнес‑анализ: ML‑скоринг для банка‑стартапа (замена эвристик на ML)

### Контекст
Мы создаём цифровой банк‑стартап. В текущем процессе кредитования используются статические правила и эвристики. Это приводит к недоодобрениям «хороших» клиентов и переодобрениям «плохих», снижая Net Interest Income и повышая Cost of Risk. Наша цель — заменить эвристики промышленным ML‑скорингом с объяснимостью, калибровкой вероятности дефолта и операционным SLA.

### 1. Бизнес‑анализ (Business Understanding)
- Организационная структура и участники
  - C‑level: CRO (Chief Risk Officer), CCO (Chief Commercial Officer)
  - Product/Business: Product Owner (Lending), Head of Lending
  - Risk/Analytics: Head of Risk Analytics, Underwriting Lead
  - Data/ML: Head of ML, ML Engineers, Data Engineers
  - Tech/Интеграции: Backend Lead, CRM/Decision Engine Lead, DevOps/Platform
  - Основные пользователи (2 когорты): андеррайтеры и риск‑аналитики; фронт‑офис и цифровые каналы
- Контакты и рабочие чаты
  - SteerCo (стратегия, 2×/мес), Core WG (еженедельно), Инциденты 24×7, Dev/Integrations канал, канал поставщиков данных
- Бизнес‑цели проекта (SMART)
  - Увеличить NII на +X% за 6 месяцев после запуска ML‑скоринга
  - Повысить Approval Rate на +Y п.п. при CoR ≤ T bps в течение 3 месяцев пилота
  - Снизить ECL на Z% к месяцу №6 без падения конверсии
  - Обеспечить p95 латентности ≤ 150 мс и Uptime ≥ 99.9% со спринта №3
  - Достичь калибровки: ECE ≤ 1.5%, Brier ≤ 0.12 к месяцу №4; 100% решений с reason‑codes
- Целевая техническая метрика: AUC‑ROC (приоритет) или Gini; $ \mathrm{Gini} = 2 \times \mathrm{AUC} - 1 $.
- Существующие решения и ограничения
  - Сейчас: эвристики/правила по сегментам, экстраполяция на всех клиентов
  - Проблемы: грубый отбор, отсутствие калиброванной PD, сниженная конверсия, избыточный риск, ручные оверрайды
  - Возможность: ML‑скоринг с лучшей дискриминацией, калибровкой PD, объяснимостью и SLA

### Глоссарий и формулы
- Net Interest Income (NII): $ \mathrm{NII} = \mathrm{Процентные\ доходы} - \mathrm{Процентные\ расходы} $.
- Cost of Risk (CoR): $ \mathrm{CoR} = \frac{\mathrm{Расходы\ на\ резервы}}{\mathrm{Средний\ кредитный\ портфель}} $.
- Probability of Default (PD): вероятность дефолта за горизонт, напр. 12 мес.
- Loss Given Default (LGD): доля невозврата при дефолте.
- Exposure at Default (EAD): задолженность на момент дефолта.
- Expected Credit Loss (ECL): $ \mathrm{ECL} = \mathrm{PD} \times \mathrm{LGD} \times \mathrm{EAD} $.
- Approval Rate: $ \mathrm{Approval\ Rate} = \frac{\mathrm{Одобренные\ заявки}}{\mathrm{Все\ заявки}} $.
- AUC‑ROC: площадь под ROC‑кривой (0.5–1.0).
- Gini: $ \mathrm{Gini} = 2 \times \mathrm{AUC} - 1 $.
- KS: максимум расстояния между CDF «хороших» и «плохих».
- Brier Score: $ \mathrm{Brier} = \frac{1}{N}\sum_{i=1}^{N}(p_i - y_i)^2 $.
- Expected Calibration Error (ECE): $ \mathrm{ECE} = \sum_{b=1}^{B}\frac{|S_b|}{N}\, \big|\mathrm{acc}(S_b) - \mathrm{conf}(S_b)\big| $.
- Uptime: $ \mathrm{Uptime} = 1 - \frac{\mathrm{Время\ простоя}}{\mathrm{Календарное\ время}} $.
- p95 латентности: 95‑й перцентиль времени ответа.
- ROI (упрощённо): $ \mathrm{ROI} = \frac{\mathrm{Доп.\ прибыль} - \mathrm{Затраты}}{\mathrm{Затраты}} $.

### 1.1 Текущая ситуация (Assessing current solution)
- Ресурсы и команда: выделены Product Owner, Underwriting Lead, 2 ML, 1 DE, 2 BE, DevOps (0.5 FTE)
- Инфраструктура: kubernetes/containers, feature store, мониторинг (Prometheus/Grafana), логирование; при необходимости — облачные GPU/CPU
- Данные и доступы
  - Внутренние источники: CRM/Decision Engine, core banking, транзакции, KYC/AML
  - Внешние источники: кредитные бюро, antifraud, гос‑реестры (по контрактам и SLO)
  - Хранение: DWH/облако; доступы предоставляются через согласованный процесс безопасности
- Экспертность: андеррайтинг и риск‑аналитики доступны для регулярных консультаций (2–4 ч/нед)
- Риски и план снижения
  - Сроки: буфер по критическим задачам, фазы shadow → A/B → rollout
  - Данные: аудит качества/полноты, план дообогащения, fallback на baseline
  - Отсутствие закономерностей: зафиксированы минимальные пороги (baseline vs ML), early‑stop пилота
  - Регуляторика и fairness: reason‑codes, документация модели, контроль смещений
  - Операционные риски: p95 SLA, деградация сервиса, ретраи, кэширование дорогих фичей

### Бизнес‑цели (SMART)
- Увеличить NII на +X% за 6 месяцев после запуска ML‑скоринга
  - Specific: рост процентного дохода при контроле расходов на фондирование
  - Measurable: NII (см. формулу)
  - Achievable: за счёт повышения качества отбора (больше «хороших» одобрений)
  - Relevant: ключевая цель банка‑стартапа
  - Time‑bound: 6 месяцев
- Повысить Approval Rate на +Y п.п. при фиксированном CoR ≤ T bps в течение 3 месяцев пилота
  - Measurable: Approval Rate, CoR (формулы выше)
- Снизить ECL на Z% для одобренных заявок без падения конверсии, к месяцу №6
  - Measurable: ECL = PD×LGD×EAD
- Обеспечить SLA: p95 латентности ≤ 150 мс, Uptime ≥ 99.9% в месяц, начиная со спринта №3
- Достичь калибровки: ECE ≤ 1.5% и Brier ≤ 0.12 на hold‑out к месяцу №4
- Объяснимость: 100% решений с reason‑codes (топ‑факторы), среднее время разбора кейса < 10 минут к месяцу №3

### 1.2 Решаемые задачи с точки зрения аналитики (Data Mining goals)
- Цель моделирования: предсказать PD (12 мес) и обеспечить ранжирование для стратегии одобрения/лимитов
- Основные метрики качества модели
  - Дискриминация: AUC‑ROC (primary), Gini = 2×AUC − 1, KS
  - Калибровка: Brier Score, Expected Calibration Error (ECE)
  - Бизнес‑метрики: Approval Rate при фиксированном CoR, ΔECL, ΔNII
- Критерии успешности
  - Минимум: AUC ≥ 0.75, KS ≥ 0.35, Brier ≤ 0.15, ECE ≤ 2.5%
  - Цель: AUC 0.80–0.82, KS ≥ 0.45, Brier ≤ 0.12, ECE ≤ 1.5%
  - Бизнес: +Y п.п. Approval при CoR ≤ T bps; −Z% ECL; +X% NII на пилоте
- Если объективный критерий не применим: оценка через shadow/A‑B тесты на потоках, сравнение ΔApproval@CoR, ΔECL, ΔNII относительно baseline

### 1.3 План проекта (Project Plan, 6 фаз CRISP‑DM)
- 1) Business Understanding (нед. 1–2): цели/SMART, требования, риски, контракт API v0.1
- 2) Data Understanding (нед. 1–3): инвентаризация источников, аудит качества/дрейфа, карточки фичей
- 3) Data Preparation (нед. 2–6): фичестор, пайплайн сборки фичей, train/validation сплиты, обработка пропусков
- 4) Modeling (нед. 4–7): baseline + ML (GBM), калибровка PD, reason‑codes/SHAP, подбор cut‑offs
- 5) Evaluation (нед. 7–9): offline валидация (AUC/KS, Brier/ECE), документирование, подготовка shadow
- 6) Deployment (нед. 9–12): shadow → ограниченный A/B, мониторинг (p95, Uptime, дрейф), fallback, обучение пользователей
- Выходы фаз: спецификация требований, датасеты/фичи, модель и артефакты, отчёт по качеству, план релиза, эксплуатационная документация

### Целевые пользователи (2 когорты)
- Андеррайтеры и риск‑аналитики
  - Задачи: обоснование решений (reason‑codes), сценарный анализ, контроль дрейфа и стабильности модели, аудит.
  - Боли: «чёрный ящик», долгий разбор кейсов, ручные оверрайды.
  - Выгоды: объяснимые решения, быстрая диагностика, снижение ручных исключений.
- Команды фронт‑офиса и цифровых каналов (продажи, мобильные/веб‑приложения, CRM/Decision Engine)
  - Задачи: быстрые статусы заявок, прозрачные причины отказов/лимитов, стабильная интеграция.
  - Боли: задержки в ответах, непредсказуемые изменения API, сложная коммуникация с клиентом.
  - Выгоды: p95 ≤ 150 мс, предсказуемый контракт, рост конверсии и LTV.

### Ценность банка и продукта
- Для банка: «It just works» + «умнее и надёжнее, чем эвристики». Больше качественных одобрений при контроле CoR ⇒ рост NII и комиссий.
- Для сотрудников: меньше ручных оверрайдов, понятные причины решения, быстрее закрывать задачи и достигать планов.
- Для клиентов: справедливые и быстрые решения, понятная обратная связь.

### Существующее решение и разрыв
- Сейчас: эвристики по сегментам, экстраполяция на всех. Прозрачные, но грубые.
- Проблемы: потеря конверсии «хороших», избыточный риск «плохих», отсутствие калиброванной PD, ручные оверрайды.
- Возможность: ML‑модель с лучшей дискриминацией (AUC/Gini/KS), калибровкой PD, reason‑codes и промышленным SLA.

### Стейкхолдеры и роли
- C‑level: CRO/CCO; Product/Tech: Head of Lending, Head of Risk Analytics, Head of ML; Операции: Front‑office lead; Интеграции: CRM/Decision Engine lead.

### Каналы коммуникации
- SteerCo (стратегия), Core WG (еженедельно), инциденты 24×7, Dev‑канал, документация и демо‑сессии, тренинги для фронта/андеррайта.

### Бизнес‑модель
- Внутренний продукт банка‑стартапа: CAPEX/OPEX на разработку и поддержку; эффект измеряется ΔNII, ΔApproval при фиксированном CoR, ΔECL.
- Масштабирование наружу (после зрелости): B2B SaaS/API (₽ за заявку), enterprise‑подписки (SLO/SLA, on‑prem), консалтинг по внедрению.

### Экономический пример (иллюстративный)
- Допущения: 50 000 заявок/мес; средний EAD = 200 000 ₽; LGD = 45%; базовый PD по одобренным = 4.0%; после ML PD = 3.6% (‑0.4 п.п.); Approval +2 п.п. ⇒ +1 000 одобрений.
- Изменение ECL на заявку: $ \Delta \mathrm{ECL} = (0.036 - 0.040) \times 0.45 \times 200\,000 = -360\ \mathrm{₽} $.
- Эффект по ECL: 50 000 × (‑360 ₽) = ‑18 млн ₽/мес (снижение ожидаемых потерь).
- Эффект от +1 000 одобрений: пусть средняя маржа на выданный кредит = 8 000 ₽ ⇒ +8 млн ₽/мес.
- Совокупно до затрат: ≈ 26 млн ₽/мес. Даже при затратах 4 млн ₽/мес на модель/инфраструктуру ROI ≈ $ \frac{26 - 4}{4} \approx 5.5\times $.

### Риски и допущения
- Качество источников (бюро, antifraud), регуляторика (объяснимость, fairness), дрейф данных, операционная латентность и стоимость фичей.
- Митигирующие меры: мониторинг, fallback, A/B и shadow, версионирование, фичестор/кэш, ретраи.

### Позиционирование (X, Y, Z, P, S, V)
Мы, компания X (банк‑стартап), помогаем клиентам типа Y (командам риска и продаж)
в ситуации Z (роста без потери качества портфеля) решать проблему P (эвристики не масштабируются и не точны)
с помощью технологии S (интерпретируемый ML‑скоринг с калиброванной PD и SLA)
и получать ценность V (больше качественных одобрений, ниже ECL и стабильный процесс).

### План внедрения
- Недели 1–4: сбор данных, базовая модель, калибровка, reason‑codes, API v1.
- Недели 5–8: shadow‑тест, дашборды, алерты, SLA обкатка.
- Недели 9–12: ограниченный A/B, итоговый rollout, ретроспектива и план улучшений.
